<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta content="telephone=no" name="format-detection" />
    <link rel="shortcut icon" type="image/ico" href="/yuer.ico">
	<title>我要报名</title>
	<style type="text/css">
		html{width:100%; height:100%; -webkit-tap-highlight-color:transparent;}
		body,ul,li,p,h3,h4,h2,em,button,input{margin: 0; padding: 0;}
		body{font-family:Hiragino Sans GB W3,'微软雅黑',Heiti SC; 
			font-size:62.5%; font-style:normal;  margin:0 auto; height:100%; color:#9da4ad; 
			background: #f0f6ff; overflow-x:hidden; -webkit-overflow-scrolling:touch;}
		img{border:0; max-width:100%;vertical-align: top;}
		img.m-btn{display:block;position:absolute;width:45%;top:48%;left:27%;}
		/*成功的状态*/
		.m-layer{
			display:none;
			position:fixed;
			top:0;left:0;
			width:100%;height:100%;
			background:rgba(0,0,0,0.6);
			z-index:999999;
		}
		.g-s{
			position:fixed;
			width:80%;
			height:30%;
			top:0;
			right:0;
			bottom: 0;
			left: 0;
			margin:auto;
			background:#fff;
			border-radius:5px;
			z-index:999;
		}
		img.g-s-img{
			display:inline-block;
			width:50px;
			height:70px;
			margin:10% 45%;
		}
		p.g-s-c{
			font-size:13px;
			color:#647580;
			width:90%;
			text-align:center;
			margin:0 auto;
		}
		img.g-s-c{
			display:inline-block;
			width:30px;
			height:85px;
			margin:10% 45%;
			position:absolute;
			top:57%;
		}
		/*不成功的状态*/
		.m-layers{
			display:none;
			position:fixed;
			top:0;left:0;
			width:100%;height:100%;
			background:rgba(0,0,0,0.6);
			z-index:999999;
		}
		.g-f{
			position:fixed;
			width:80%;
			height:30%;
			top:0;
			right:0;
			bottom: 0;
			left: 0;
			margin:auto;
			background:#fff;
			border-radius:5px;
			z-index:999;
		}
		img.g-f-img{
			display:inline-block;
			width:50px;
			height:70px;
			margin:10% 42.5%;
		}
		p.g-f-c{
			font-size:13px;
			color:#647580;
			width:90%;
			text-align:center;
			margin:0 auto;
		}
		img.g-f-c{
			display:inline-block;
			width:30px;
			height:85px;
			margin:10% 45%;
			position:absolute;
			top:57%;
		}
	</style>
</head>
<body>
<div class="g-container">
	<img src="/cash/images/s-bg-1.jpg">
	<img src="/cash/images/s-bg-2.jpg">
	<img src="/cash/images/s-bg-3.jpg">
	<img src="/cash/images/s-btn.png" class="m-btn" id="btn">
</div>
<div class="m-layer">
	<div class="g-s">
		<img src="/cash/images/s-success.jpg" class="g-s-img">
		<p class="g-s-c">报名成功</p>
	</div>
	<img src="/cash/images/s-close.png" class="g-s-c" id="gsc">
</div>
<div class="m-layers">
	<div class="g-f">
		<img src="/cash/images/pc-empty.jpg" class="g-f-img">
		<p class="g-f-c">失败</p>
	</div>
	<img src="/cash/images/s-close.png" class="g-f-c" id="gfc">
</div>
<script type="text/javascript" src="/jquery.min.js"></script>
<script type="text/javascript">
$(function(){
	// 失败状态的切换
	function showTips(textc){
		$(".m-layers").show().find("p").text(textc);
	}
	// 点击叉号关闭弹框
	$("#gsc").on("click",function(){
		$(".m-layer").hide();
	})
	$("#gfc").on("click",function(){
		$(".m-layers").hide();
	})
	// 报名成功的跳转
	$(".m-layer").on("click",function(){
		window.location.href="/cash/personcenter";
	})
	// 获取参数
	function getQueryString(name) {
	    var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
	    var r = window.location.search.substr(1).match(reg);
	    if (r != null) {
	        return unescape(r[2]);
	    }
	    return null;
	}
	var userId = getQueryString("userId"),
		token = getQueryString("token");
	// var userId="",
	// 	token="";
	// $.ajax({
	//     method: "GET",
	//     url: "http://172.16.10.11:8777/login?password=123456&nickname=18257153272",
	//     dataType: 'json',
	//     success: function(data) {
	//     	if(data.code==0){
	//     		userId=data.object.id; 
 //                token=data.object.token; 
	//     		console.log(userId);
	// 	console.log(token);
	//     	}
	//     },
	//     error: function(a, b, c) {
	//         console.log("接口出问题啦");
	//     }
	// }); 
	//用户状态
	$("#btn").on("click",function(){
		var ua = navigator.userAgent.toLowerCase(); 
		if(ua.match(/YuertvBrowser/i)=="yuertvbrowser"){
			var parm={
				userId:userId,
				token:token,
			}
			$.ajax({
			    method: "GET",
			    url: "/api/withdraw/enroll",
			    dataType: 'json',
			    data:parm,
			    success: function(data) {
			    	if(data.code==0){
			    		console.log(data.code);
			    		if(data.object.code==0){
				    		$(".m-layer").show();
				    	}else if(data.object.code==1){
				    		showTips("失败；已报名，无需重复报名 ");
				    	}else if(data.object.code==2){
				    		console.log(data.object.code);
				    		showTips("请绑定手机并实名认证后再报名");
				    	}else if(data.object.code==3){
				    		showTips("签约主播不能报名");		    		
				    	}
			    	}else if(data.code == -1){
			    		showTips("登录状态已失败，请登录 ");
			    		window.location.href = "yuertvopen://login";
			    	}else if(data.code == -4){
			    		showTips("你还没有登录请登录 ");
			    		window.location.href = "yuertvopen://login";
			    	}else{
			    		alert(data.result);
			    	}	
			    },
			    error: function(a, b, c) {
			        console.log("接口出问题啦");
			    }
			}); 
		}else{
			window.location.href = "https://yuertvfile.wangyuhudong.com";
		}
	})
		
})
</script>
</body>
</html>