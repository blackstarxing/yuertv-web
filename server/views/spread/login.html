<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>obs直播</title>
	<link rel="shortcut icon" type="image/ico" href="/yuer.ico">
	<style>
		html{width:100%; height:100%; -webkit-tap-highlight-color:transparent;}
		body,ul,li,p,h3,h4,h2,em,button,input{margin: 0; padding: 0;}
		body{font-family:Hiragino Sans GB W3,'微软雅黑',Heiti SC; 
			font-size:62.5%; font-style:normal;  margin:0 auto;
			height:100%; color:#9da4ad; 
			background: #17121d; 
			overflow-x:hidden; 
			-webkit-overflow-scrolling:touch;
		}
		img{border:0; max-width:100%;vertical-align: top;}
		.g-con .g-bg-r{
			position:relative;
		}
		.m-login{
			position:absolute;
			width:25%;
			height:38.5%;
			border-radius:5%;
			background:rgba(49,62,76,0.3);
			top:27.5%;
			left:37.5%;
		}
		input::-webkit-input-placeholder { /* WebKit browsers */ 
		    color: #b6c0cd; 
		    font-size:15px;
		    padding-left:2%;
		} 
		input:-moz-placeholder { /* Mozilla Firefox 4 to 18 */ 
		    color: #b6c0cd; 
		    font-size:15px;
		    padding-left:2%;
		} 
		input::-moz-placeholder { /* Mozilla Firefox 19+ */ 
		    color: #b6c0cd; 
		    font-size:15px;
		    padding-left:2%;
		} 
		input:-ms-input-placeholder { /* Internet Explorer 10+ */ 
		    color: #b6c0cd; 
		    font-size:15px;
		    padding-left:2%;
		} 
		.m-login input{
			display:block;
			width:85%;
			height:40px;
			line-height:40px;
			border-radius:5px;
			margin:0 auto;
			margin-top:10%;
			border:1px solid #3c4856;
			background:#272c39;
			color:#b6c0cd;
		}
		input.u-tel{
			margin-top:10%;
			color:#b6c0cd;
		}
		input.u-pw{
			margin-top:5%;
			color:#b6c0cd;
		}
		.m-login span{
			display:block;
			font-size:14px;
			height: 20px;
			line-height: 20px;
			color:#f36;
			margin:0 0 0 8%;
		}
		span.u-sl-empty,span.u-sl-length{
			display:block;
			font-size:14px;
			color:#f36;
			margin:2% 0 0 0%;
		}
		.u-open{
			display:block;
			border:none;
			width:85%;
			height:12%;
			line-height:12%;
			border-radius:5px;
			margin:0 auto;
			margin-top:10%;
			text-align:center;
			font-size:16px;
			color:#fff;
			background:#f36;
			margin-bottom:15%;
		}
		/*第二块*/
		.m-title{
			position:absolute;
			width:25%;
			border-radius:5%;
			background:rgba(49,62,76,0.3);
			top:27.5%;
			left:37.5%;
			margin-bottom:3%;
		}
		.u-clm{
			width:85%;
			margin-left:7.5%;
			margin-top:10%;
		}
		.u-obsclm{
			font-size:14px;
			color:#999;
			word-wrap:break-word;
		}
		.u-copy{
			border:none;
			display:inline-block;
			width:20%;
			height:30px;
			background:#f36;
			border-radius:5px;
			font-size:18px;
			color:#fff;
			text-align:center;
		}
		.u-clmdesc{
			font-size:13px;
			color:#52c4f8;
			margin-left:2%;
		}
		.u-hostgame{
			margin-left:7.5%;
			width:85%;
			/*margin-top:33%;*/
		}
		input.u-sl,input.u-sgame{
			display:block;
			width:100%;
			height:40px;
			line-height: 40px;
			border-radius:5px;
			margin:0 auto;
			margin-top:15px;
			border:1px solid #3c4856;
			background:#272c39;
			color:#b6c0cd;
		}
		.u-start{
			display:block;
			border:none;
			width:100%;
			height:40px;
			border-radius:5px;
			margin:0 auto;
			margin-top:10%;
			text-align:center;
			font-size:16px;
			color:#fff;
			background:#f36;
			margin-bottom:10%;
		}
		/*第三块*/
		.m-select{
			position:absolute;
			width:47%;
			background:#141a20;
			top:20%;
			left:27%;
			z-index:99;
		}
		.m-s-top{
			width:100%;
			background:#1c232d;
			font-size:21px;
			color:#fff;
		}
		span.m-st-select{
			display:inline-block;
			margin:2% 0 2% 4%;
		}
		.m-s-recently{
			width:95%;
			height:20%;
			margin:3.5% auto;
		}
		.m-s-all{width:95%;margin:0 auto;height:45%;line-height:45%;padding-top: 15px;}
		.m-s-recently h4,h4.m-sa-title{
			line-height:100%;
			font-size:16px;
			color:#fff;
			border-left:2px solid #f36;
			padding-left:1%;
		}
		.m-sr-select,.m-sa-all{overflow:hidden;padding-left: 4%;}
		.m-srs{
			width:30%;
			height:73px;
			line-height:73px;
			float:left;
			background:#242d3c;
			border-radius:5px;
			margin-top:2%;
			margin-right:2.5%;
			cursor:pointer;
		}
		.m-srs img{
			display:inline-block;
			width:50px;
			height:50px;
			margin:7.5% 5px;
			border-radius:5px;
		}
		.m-srs span{
			display:inline-block;
			font-size:18px;
			color:#98a9bb;
			margin-left:5px;
		}
		.m-s-describe{
			width:95%;
			font-size:16px;
			color:#98a9bb;
			margin-left:2.8%;
			padding:3% 0%;
		}
		.m-s-describe p{
			margin-top:2%;
		}
		/*第四块*/
		.m-c-obs{
			width:75%;
			margin:20% auto 10%;
			font-size:15px;
			color:#999;
		}
		.g-jump{
			position: absolute;
		    height: 2%;
		    line-height: 2%;
		    margin-top: 10px;
		    width: 100%;
		    top: 93%;
		    /* left: 40%; */
		    text-align: center;
		    font-size: 14px;
		    color: #fff;
		    cursor: pointer;
		}
		.m-layer{
			display:none;
			position:fixed;
			top:0;left:0;
			width:100%;height:100%;
			background:rgba(0,0,0,0.6);
			z-index:999999;
		}
		.m-bounced{
			position:fixed;
			width:20%;
			height:18%;
			top:0;
			right:0;
			bottom: 0;
			left: 0;
			margin:auto;
			background:#323a43;
			border-radius:5px;
			z-index:999;
		}
		img.m-b-img{
			display:inline-block;
			width:30px;
			height:30px;
			margin:10% 45%;
		}
		p.m-b-f{
			font-size:16px;
			color:#999;
			margin:0 20%;
		}
		.m-layers{
			display:none;
			position:fixed;
			top:0;left:0;
			width:100%;height:100%;
			background:rgba(0,0,0,0.6);
			z-index:999999;
		}
		.m-bounceds{
			position:fixed;
			width:20%;
			height:18%;
			top:0;
			right:0;
			bottom: 0;
			left: 0;
			margin:auto;
			background:#323a43;
			border-radius:5px;
			z-index:999;
		}
		img.m-b-imgs{
			display:inline-block;
			width:30px;
			height:30px;
			margin:10% 45%;
		}
		p.m-b-fs{
			font-size:16px;
			color:#999;
			margin:0 20%;
		}
		.m-layersg{
			display:none;
			position:fixed;
			top:0;left:0;
			width:100%;height:100%;
			background:rgba(0,0,0,0.6);
			z-index:999999;
		}
		.m-bouncedsg{
			position:fixed;
			width:20%;
			height:18%;
			top:0;
			right:0;
			bottom: 0;
			left: 0;
			margin:auto;
			background:#323a43;
			border-radius:5px;
			z-index:999;
		}
		img.m-b-imgsg{
			display:inline-block;
			width:30px;
			height:30px;
			margin:10% 45%;
		}
		p.m-b-fsg{
			font-size:16px;
			color:#999;
			margin:0 20%;
			text-align: center;
		}
		.m-layerw{
			display:none;
			position:fixed;
			top:0;left:0;
			width:100%;height:100%;
			background:rgba(0,0,0,0.6);
			z-index:999999;
		}
		.m-bouncedw{
			position:fixed;
			width:20%;
			height:18%;
			top:0;
			right:0;
			bottom: 0;
			left: 0;
			margin:auto;
			background:#323a43;
			border-radius:5px;
			z-index:999;
		}
		img.m-b-imgw{
			display:inline-block;
			width:30px;
			height:30px;
			margin:10% 45%;
		}
		p.m-b-fw{
			font-size:16px;
			color:#999;
			margin:0 30%;
		}
		.m-layerws{
			display:none;
			position:fixed;
			top:0;left:0;
			width:100%;height:100%;
			background:rgba(0,0,0,0.6);
			z-index:999999;
		}
		.m-bouncedws{
			position:fixed;
			width:23%;
			height:28%;
			top:0;
			right:0;
			bottom: 0;
			left: 0;
			margin:auto;
			background:#323a43;
			border-radius:5px;
			z-index:999;
		}
		img.m-b-imgws{
			display:inline-block;
			width:30px;
			height:30px;
			margin:6% 45%;
		}
		p.m-b-fws{
			font-size:16px;
			color:#999;
			margin:0 4%;
			font-size:14px;
			color:#fff;
		}
		.m-b-ws{
			border:none;
			display:block;
			width:50%;
			height:30px;
			background:#f36;
			border-radius:5px;
			margin:10% 25%;
			text-align:center;
			color:#fff;
			font-size:15px;
			/*margin-bottom:5%;*/
		}
		.u-btn-radio{
			display:block;
			width:100%;
			color:#b6c0cd;
			font-size:18px;
			margin-top:5%;
		}
		.u-btn-radio label{
			display:inline-block;
			width:30%;
			height:30px;
			line-height:30px;
			font-size:17px;
			color:#fff;
			text-align:center;
			/*background:#f36;*/
			border-radius:5px;
			margin-top:3%;
		}
		label.u-label{margin-left:38%;}
		.u-btn-radio input{margin-right:10%;}
		input.addclass{
			border:1px solid #f36;
		}
		input{
			outline:none;
			text-indent:5px;
		}
		button.u-start,button.u-open,button.u-copy{
			margin-top:15px;
		}
	</style>
</head>
<body>
	<div class="g-con">
		<img src="/images/obs_bg.jpg" alt="" class="g-bg-r">
		<div class="g-main">
			<div class="m-login" id="m-login">
				<input type="text" name="" id="u-tel" class="u-tel" placeholder="手机号码" onkeyup="this.value=this.value.replace(/\D/g,'')" oninput="if(value.length>11)value=value.slice(0,11)">
				<div style="height:20px;margin-top: 5px;">	
					<span class="u-tel-empty" style="display:none;">手机号码不能为空</span>
					<span class="u-tel-wrong" style="display:none;">手机号码错误</span>
					<span class="u-tel-nouser" style="display:none;">用户不存在</span>
				</div>
				<input type="password" name="" id="u-pw" class="u-pw" placeholder="密码">
				<div style="height:20px;margin-top: 5px;">
					<span class="u-pw-empty" style="display:none;">密码不能为空</span>
					<span class="u-pw-wrong" style="display:none;">密码错误</span>
				</div>
				
				<div style="height:310px;margin-bottom:5%;"><button class="u-open" id="u-open">开启直播</button></div>
			</div>
			<div class="m-select" style="display:none;">
				<div class="m-s-top">
					<span class="m-st-select">选择游戏</span>
				</div>
				<!-- <div class="m-s-recently">
					<h4 class="m-sr-select">最近选择</h4>
					<div class="m-sr-select">
					{% for index in index %}
						<div class="m-srs">
				              {% if index.icon.indexOf('http')>-1 %}
				              <img src="{{index.icon}}" alt="" class="m-srs-icon">
				              {% else %}
				              <img src="http://img.wangyuhudong.com/{{index.icon}}" alt="" class="m-srs-icon">
				              {% endif %}
							<span class="m-srs-gname" data-id="{{index.id}}">{{index.name}}</span>
						</div>
					{% endfor %}
					</div>
				</div> -->
				<div class="m-s-all">
					<!-- <h4 class="m-sa-title">全部游戏</h4> -->
					<div class="m-sa-all">
					{% for index in index %}
						<div class="m-srs">
							{% if index.icon.indexOf('http')>-1 %}
				              <img src="{{index.icon}}" alt="" class="m-srs-icon">
				            {% else %}
				              <img src="http://img.wangyuhudong.com/{{index.icon}}" alt="" class="m-srs-icon">
				            {% endif %}
							<span class="m-srs-gname" data-id="{{index.id}}">{{index.name}}</span>
						</div>
					{% endfor %}
					</div>
				</div>
				<div class="m-s-describe">
					<p>没找到您喜欢的游戏？您可以选择上方游戏列表中的“综合手游” </p>
					<p>我们的工作人员将尽快添加您喜爱的游戏^_^！</p>
				</div>
			</div>
			<div class="m-title" style="display:none;">
				<div class="u-clm">
					<p id="code" class="code u-obsclm"></p>
					<button class="u-copy" data-clipboard-target="#code">复制</button>
					<span class="u-clmdesc">开始直播后记得回来完善信息</span>
				</div>
				<div class="u-hostgame">
					<input type="text" name="" id="u-sl" class="u-sl" placeholder="请输入直播标题">
					<div style="height:20px;">
						<span class="u-sl-empty" style="display:none;">直播标题不能为空</span>
						<span class="u-sl-length" style="display:none;">直播标题不要超过20位</span>
					</div>
					<input type="text" name="" placeholder="请选择游戏" readOnly="true" class="u-sgame" id="u-sgame" >
					<form action="" method="get" class="u-btn-radio"> 
					    请选择横竖屏<br/>
					    <label><input name="screen" type="radio" value="0" checked="" id="u-btn-screen" class="u-btn-s"/>横屏</label> 
					    <label class="u-label"><input name="screen" type="radio" value="1" id="u-btn-sc" class="u-btn-sc"/>竖屏</label> 
    				</form> 
					<button class="u-start" id="u-start">开始直播</button>
				</div>
			</div>	
		</div>
		<div class="g-jump" id="g-jump">
			点击加入娱儿直播官方群：<span style="color:#f36">421322720</span>
		</div>
	</div>
	<div class="m-layer">
		<div class="m-bounced">
			<img src="/images/iconcancel.png" alt="" class="m-b-img"> 
			<p class="m-b-f">主播链接已复制，快去直播吧！</p>
		</div>
	</div>
	<div class="m-layerws">
		<div class="m-bouncedws">
			<img src="/images/wrong.png" alt="" class="m-b-imgws"> 
			<p class="m-b-fws">复制串流码后请务必回来输入房间标题以及并选择开播游戏，如因此造成开播时长、收益等受到影响概不负责</p>
			<button class="m-b-ws">我一定会回来的</button>
		</div>
	</div>
	<div class="m-layers">
		<div class="m-bounceds">
			<img src="/images/wrong.png" alt="" class="m-b-imgs"> 
			<p class="m-b-fs">链接复制失败，请手动复制！</p>
		</div>
	</div>
	<div class="m-layersg">
		<div class="m-bouncedsg">
			<img src="/images/wrong.png" alt="" class="m-b-imgsg"> 
			<p class="m-b-fsg">请选择开播游戏！</p>
		</div>
	</div>
	<div class="m-layerw">
		<div class="m-bouncedw">
			<img src="/images/wrong.png" alt="" class="m-b-imgw"> 
			<p class="m-b-fw">主播不在线！</p>
		</div>
	</div>
	<script src="/jquery.js"></script>
	<script src="/clipboard.min.js"></script>
	<script>
		$(function(){
			// 第一块的登录
			// 确保输入框纯数字
			var keyword="";
			var keyname="";
			var title="";
			var id="";
			var token="";
			var content="";
			var screen=0;
			var clipboard = new Clipboard('.u-copy');
			clipboard.on('success', function(e) {
				showTip(".m-layer");
		    });
		    clipboard.on('error', function(e) {
		    	showTip(".m-layers");
			});
			// 错误弹出提示
			function showTip(cname){
				$(cname).show();
		        setTimeout(function(){
		            $(cname).hide();
		        },1500);
			}
			function showTips(textc){
				$(".m-layer").text(textc).show();
		        setTimeout(function(){
		            $(".m-layer").hide();
		        },1500);
			}
			function show(show){
				$(show).show();
		        setTimeout(function(){
		            $(show).hide();
		        },2000);
			}
	        // $("#u-tel").off("keydown").on("keydown",function(e){
	        //     if((e.keyCode >=48 && e.keyCode <=57)||(e.keyCode >=97 && e.keyCode <=105)||(e.keyCode == 8)||(e.keyCode == 9)){
	            
	        //     }else{
	        //         e.preventDefault();
	        //     }
	        // })
			$("#u-tel").on("blur",function(){
				if($("#u-tel").val()!=''){
					if(/^1[34578][0-9]{9}$/.test($('#u-tel').val())){
		                $(".u-tel-wrong").hide();
		            }else{
		            	$(".u-tel-empty").hide();
			            show(".u-tel-wrong");
		            }		
				}else{
					// $(".u-tel-empty").show();
					show(".u-tel-empty");
				}				
			})	
			$("#u-pw").on("blur",function(){
				if($("#u-pw").val()==''){
					// $(".u-pw-empty").show();
					show(".u-pw-empty");
				}else{
					$(".u-pw-empty").hide();
				}
			})
			$("#u-open").on("click",function(){
				if($("#u-tel").val()!='' && $("").val()!=''){
					$.ajax({
		                method: "GET",
		                url: "http://api.yuerlive.cn/login",
		                dataType: 'json',
		                data: {
		                    username:$("#u-tel").val(),
		                    password:$("#u-pw").val(),
		                    type:3,
		                },
		                success: function(data) {
		                    if(data.code == 0){
		                    	$(".m-login").hide();
		                        $(".m-layerws").show();
		                        id=data.object.id;
		                        token=data.object.token;
		                        content=data.object.rtmp;
		                        $(".u-obsclm").text(content);
		                    }else if(data.code == 1){
	                            $("#m-login").find("span").each(function(){
	                                if($(this).attr("class").indexOf("u-tel-nouser") != -1){
	                                    show(this);
	                                }else{
	                                    $(this).hide();
	                                }
	                                if($(this).attr("class").indexOf("u-pw-wrong") != -1){
	                                   show(this);
	                                }else{
	                                    $(this).hide();
	                                }
	                            });
	                        }else{
		                        alert(data.result);
		                    }
		                },
		                error: function(a, b, c) {
		                    console.log("接口出问题啦");
		                }
		            });
				}else{
					$("#m-login").find("span").each(function(){
                        if($(this).attr("class").indexOf("u-tel-empty") != -1){
                            show(this);
                        }
                        if($(this).attr("class").indexOf("u-pw-empty") != -1){
                            show(this);
                        }
                    });
				}     
	        });
	        $(".m-b-ws").on("click",function(){
	        	$(".m-layerws").hide();
	        	$(".m-title").show();
	        })
	        $("#u-sgame").on("click",function(){
	        	$(".m-select").show();
	        })
	        // 第二块的选择游戏
	        $(".m-srs").on("click",function(){
	        	keyword=$(this).find(".m-srs-gname").attr('data-id');
	        	$("#u-sgame").val($(this).find(".m-srs-gname").html());
	        	$(".m-select").hide();
	        	$(".m-title").show();
	        })
	        $("#u-sl").on("blur",function(){
	        	if($("#u-sl").val()==""){
	        		// $(".u-sl-empty").show();
	        		show(".u-sl-empty");
	        	}else{
	        		$(".u-sl-empty").hide();
	        	}
	        	console.log($("#u-sl").length);
	        	if($("#u-sl").val().length>20){
	        		// $(".u-sl-length").show();
	        		show(".u-sl-length");
	        	}else{
	        		$(".u-sl-length").hide();
	        	}
	        })
	        // 横竖屏
	        // $("#u-btn-screen").on("click",function(){
	        // 	screen==0;
	        // })
	        // $("#u-btn-sc").on("click",function(){
	        // 	screen==1;
	        // })
	        $(".u-start").on("click",function(){
	        	if($(".u-sl").val()==""){
            		// $(".u-sl-empty").show();
            		show(".u-sl-empty");
            	}else if($(".u-sgame").val()==""){
            		showTip(".m-layersg");
            	}else{
            		title=$("#u-sl").val();
		        	$.ajax({
	                    method: "GET",
	                    url: "http://api.yuerlive.cn/v4/live/liveNotify",
	                    dataType: 'json',
	                    data: {
	                        gameId: keyword,
	                        screen:$('input:radio[name="screen"]:checked').val(),
	                        source:2,
	                        title:title,
	                        userId:id,
	                        token:token
	                    },
	                    success: function(data) {
	                        if(data.code == 0) {
	                        	showTips("可成功开播");
	                        	window.location.href=window.location.href;
	                            
	                        }else if(data.code ==2){
	                        	showTip(".m-layerw");
	                        }else{
	                            console.log(data.result);
	                        }
	                    },
	                    error: function(a, b, c) {
	                        console.log("接口出问题啦");
	                    }
	                })
            	}
	        	
	        })
	        // 加群的跳转
	        $("#g-jump").on("click",function(){
				window.location.href="http://qm.qq.com/cgi-bin/qm/qr?k=CydURcDl-D9axsd1Uy2U-K_9q2zYf3a1";
			})
		});
		
	</script>
</body>
</html>