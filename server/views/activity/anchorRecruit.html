<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta content="telephone=no" name="format-detection" />
	<title>娱儿直播百万薪金招募令</title>
	<script src="/jquery.js"></script>
	<script src="/jquery.sha1.js"></script>
	<script src="/wxjsapi.js"></script>
	<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
	<style>
		html{width:100%; height:100%; -webkit-tap-highlight-color:transparent;}
		body,ul,li,p,h3,h4,h2,em,button,input{margin: 0; padding: 0;}
		body{font-family:Hiragino Sans GB W3,'微软雅黑',Heiti SC; font-size:62.5%; font-style:normal; max-width: 800px; margin:0 auto; height:100%; color:#9da4ad; background: #141a20; overflow-x:hidden; -webkit-overflow-scrolling:touch;}
		img{border:0; max-width:100%;}
		li{ list-style:none;}
		a{text-decoration: none; color:#9da4ad;}
		h3{font-size: 1.5rem;line-height: 1.25;}

		.l{float:left;}.r{float:right;}
		.clearfix{*zoom:1;}.clearfix:after{display:block; content:"$"; height:0; clear:both; overflow:hidden; visibility:hidden;}

		img{
			vertical-align: top;
			line-height: 0;
		}
		.top{
			position: relative;
		}
		.acTime{
			position: absolute;
			width: 100%;
			bottom: 72px;
			text-align: center;
			color:#fff;
			font-size: 14px;
		}
		.join{
			position: absolute;
			bottom: 0;
			background: url('/activity/images/mrecruit_btn1.png') left top no-repeat;
			width: 46%;
			height: 50px;
			line-height: 50px;
			color:#3c75a8;
			text-align: center;
			background-size: 100% 100%;
			left: 50%;
			margin-left: -23%;
			font-size: 16px;
		}
		.hasjoin{
			color:#996637;
			background: url('/activity/images/mrecruit_btn2.png') left top no-repeat;
			background-size: 100% 100%;
		}
		.mask,.form-mask{
			position:fixed;
		    left:0;
		    top:0;
		    width:100%;
		    height:100%;
		    background:rgba(0,0,0,0.6);
		    display:none;
		    z-index:999999;
		}
		.tip{
			width:70%;
			margin:30% auto 0;
			position: relative;
		}
		.tip .bg{
			width: 100%;
		}
		.tip button{
			background: none;
			border:none;
		}
		.tip .close{
			width: 20%;
			position: absolute;
			right: -8%;
			top:-8%;
		}
		.tip p{
			position: absolute;
			bottom: 25px;
			text-align: center;
			color:#fff;
			font-size: 20px;
			font-weight: bold;
			padding:0 15px;
			width: 100%;
			box-sizing: border-box;
		}
		.telnumber{
			position: absolute;
			bottom:75px;
			width: 60%;
			padding:5px 0;
			font-size: 14px;
			line-height: 14px;
			border:1px solid #fff;
			box-sizing: border-box;
			border-radius: 3px;
			left: 50%;
			margin-left: -30%;
			background: #08b4dc;
			color:#fff;
			outline: none;
			text-indent: 10px;
		}
		.tip ::-webkit-input-placeholder { /* WebKit browsers */ 
		    color: #fff; 
		} 
		.tip :-moz-placeholder { /* Mozilla Firefox 4 to 18 */ 
		    color: #fff; 
		} 
		.tip ::-moz-placeholder { /* Mozilla Firefox 19+ */ 
		    color: #fff; 
		} 
		.tip :-ms-input-placeholder { /* Internet Explorer 10+ */ 
		    color: #fff; 
		} 
		.submit{
			position: absolute;
			bottom:10px;
			width: 80%;
			left: 50%;
			margin-left: -40%;
		}
		.error{
			position: absolute;
			bottom:55px;
			width: 60%;
			height: 15px;
			line-height: 15px;
			font-size: 14px;
			left: 50%;
			margin-left: -30%;
			color:#f15a5a;
			display: none;
		}
	</style>
	<script>
		if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i) || navigator.userAgent.match(/android/i)) {
			// window.location.href = '/activity/recruit';
        }else{
        	window.location.href = '/activity/hrecruit';
        }
		enableWxShare({
			appId: 'wxf96f728533f32fa8',
			ticket: '{{ticket}}',
			title: '娱儿直播百万薪金招募令！',		
			imgUrl: 'http://img.wangyuhudong.com/uploads/imgs/live/2017/yuerlogo.png',
			desc: '娱儿直播2月主播招募令，百万薪金等你瓜分！'
		})
	</script>
</head>
<body>
	<div class="m-recruit">
		<div class="top">
			<img src="/activity/images/mrecruit1.jpg" alt="">
			<p class="acTime">活动时间：2月9日-3月10日</p>
			<a href="https://yuertvfile.wangyuhudong.com" class="join">我要报名</a>
		</div>
		<img src="/activity/images/mrecruit2.jpg" alt="">
		<img src="/activity/images/mrecruit3.jpg" alt="">
		<img src="/activity/images/mrecruit4.jpg" alt="">
	</div>
	<div class="mask">
		<div class="tip">
			<button class="close"><img src="/activity/images/mrecruit_close.png" alt=""></button>
			<img src="/activity/images/mrecruit_pop.png" alt="" class="bg">
			<p></p>
		</div>
	</div>	
	<div class="form-mask">
		<div class="tip">
			<button class="close"><img src="/activity/images/mrecruit_close.png" alt=""></button>
			<img src="/activity/images/mrecruit_form.png" alt="" class="bg">
			<input type="tel" onkeyup="this.value=this.value.replace(/\D/g,'')" oninput="if(value.length>11)value=value.slice(0,11)" class="telnumber" placeholder="请输入手机号码" name="手机号码">
			<div class="error"></div>
			<button class="submit"><img src="/activity/images/mrecruit_submit.png" alt=""></button>
		</div>
	</div>
	<script>

		$('.mask,.form-mask').bind("touchmove",function(e){
			e.stopPropagation();
		    e.preventDefault();
		});

		$('.close').click(function(){
			$('.mask').hide();
			$('.form-mask').hide();
			$('input').val('');
		})
		// 获取参数
		function getQueryString(name) {
		    var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
		    var r = window.location.search.substr(1).match(reg);
		    if (r != null) {
		        return unescape(r[2]);
		    }
		    return null;
		}

		function showTip(text){
			$('.mask').show();
			$('.mask p').text(text);
		}

		function showError(text){
			$('.error').text(text).show();
	        setTimeout(function(){
	            $('.error').hide();
	        },2500);
		}

		var userId = getQueryString("userId"),
			token = getQueryString("token");

		// userAgent
		var ua = navigator.userAgent.toLowerCase(); 

		// 查询用户状态或报名
		function engaged(type){
			var parm={
				userId:userId,
				token:token,
				type:type,
				id:3
			}
			$.ajax({
			    method: "GET",
			    url: "http://yuerapi.wangyuhudong.com/activity/register",
			    dataType: 'json',
			    data:parm,
			    success: function(data) {
			    	if(data.code==-2){
			    		if(ua.match(/YuertvBrowser/i)=="yuertvbrowser"){
							$('.join').attr('href','javascript:void(0);').html('已报名').addClass('hasjoin');
						}
			    	}else if(data.code==-5){
			    		$('.join').attr('href','javascript:void(0);').html('报名已结束').addClass('hasjoin');
			    	}else if(data.code==0){
			    		showTip('报名成功')
			    		$('.join').attr('href','javascript:void(0);').html('已报名').addClass('hasjoin');
			    	}else if(data.code==-6){
			    		$('.join').attr('href','javascript:void(0);').html('活动已结束').addClass('hasjoin');
			    	}else if(data.code==-7){
			    		$('.join').attr('href','javascript:void(0);').html('活动未开始').addClass('hasjoin');
			    	}else if(data.code!=1){
			    		if(ua.match(/YuertvBrowser/i)=="yuertvbrowser"){
							showTip(data.result);
						}			    		
			    	}
			    },
			    error: function(a, b, c) {
			        console.log("接口出问题啦");
			    }
			}); 
		}
		// 页面初始状态
		engaged(0);
		

		// 报名
		$('.join').click(function(e){
			if($('.join').html()=='我要报名' && ua.match(/YuertvBrowser/i)=="yuertvbrowser"){
				e.preventDefault();
				if(userId && token){
					engaged(1);
				}else{
					window.location.href = "yuertvopen://login";
				}
			}
		})

		
		// $('.join').click(function(e){
		// 	if($('.join').html()=='我要报名' && ua.match(/YuertvBrowser/i)=="yuertvbrowser"){
		// 		e.preventDefault();
		// 		// if(ua.match(/android/i)){
		// 		// 	if(userId && token){
		// 		// 		engaged(1);
		// 		// 	}else{
		// 		// 		window.location.href = "yuertvopen://login";
		// 		// 	}
		// 		// }else{
		// 			$('.form-mask').show();
		// 		// }
		// 	}				
		// })

		$('.submit').click(function(e){
			e.preventDefault();
			if($('.telnumber').val()){
	            if(/^1[34578]\d{9}$/.test($('.telnumber').val())){
	                var parm = {};
	                parm.mobile = $('.telnumber').val();
	                parm.type = 1;
	                $.ajax({
			            url: 'http://yuerapi.wangyuhudong.com/activity/iosRegister',
			            data: parm,
			            type: 'get',
			            dataType: 'json',
			            success: function(data) {
			                if (data.code==0) {
			                    $('.form-mask').hide();
			                    $('input').val('');
			                    $('.join').attr('href','javascript:void(0);').html('已报名').addClass('hasjoin');            
			                }else{
			                    showError(data.result);  
			                }
			            },
			            error: function() {
			                showError('连接失败，请检查您的网络设置后重试');
			            }
			        });
	            }else{
	            	showError('请输入正确的手机号码！');
	            }
	        }else{
	        	showError('手机号码不能为空！');
	        }
		})
		
	</script>
</body>
</html>