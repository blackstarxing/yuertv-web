!function(t){function e(n){if(o[n])return o[n].exports;var a=o[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var o={};return e.m=t,e.c=o,e.p="./",e(0)}({0:function(t,e,o){o(9),t.exports=o(4)},4:function(t,e){$(function(){function t(){var t=document.body.clientWidth,e=document.body.offsetHeight,o=t-440,n=e-300;$(".m-live-left").css("width",o+"px"),$(".videoBox").css("height",.56*o+"px"),$(".room-block").css("height",n+"px"),t<1340?$(".send-gift").addClass("m-l-gift"):$(".send-gift").removeClass("m-l-gift")}function e(){$.ajax({method:"GET",url:"http://localhost:30000/api/gift/list",dataType:"json",success:function(t){if(0==t.code)for(var e=0;e<t.object.length;e++){var o={id:t.object[e].id,name:t.object[e].name,icon:"http://img.wangyuhudong.com/"+t.object[e].icon,tips:t.object[e].name+"（<font color='#ffff00'>10</font>鱼币）<br/>点击送给主播"};r.push(o)}else console.log(t.result)},error:function(t,e,o){console.log("接口出问题啦")}})}function o(){$.ajax({method:"GET",url:"http://localhost:30000/api/person-center/my-gifts",dataType:"json",success:function(t){if(0==t.code){for(var e="",o=0;o<t.object.gifts.length;o++){var n={id:t.object.gifts[o].id,name:t.object.gifts[o].name,icon:"http://img.wangyuhudong.com/"+t.object.gifts[o].icon,count:t.object.gifts[o].num};e+='<div class="propBox" data-name="'+t.object.gifts[o].name+'" data-id="'+t.object.gifts[o].id+'"><img src="http://img.wangyuhudong.com/'+t.object.gifts[o].icon+'" alt="">'+t.object.gifts[o].name+"<span>"+t.object.gifts[o].num+"</span></div>",d.push(n)}$(".my-prop").html(e)}else console.log(t.result)},error:function(t,e,o){console.log("接口出问题啦")}}),$.ajax({method:"GET",url:"http://localhost:30000/api/person-center/user-info",dataType:"json",success:function(t){0==t.code?(f=t.object.yuerCoin,$(".yuerCoin").html(t.object.yuerCoin)):$(".yuerCoin").html("0")},error:function(t,e,o){console.log("接口出问题啦")}})}function n(){function t(t,e){console.log("发送聊天室"+e.type+"消息"+(t?"失败":"成功")+", id="+e.idClient,t,e),t||(liveRoomInterf.flash.showDanmaku(e.text,16777215,100),$(".room-block").append('<div class="text-mes"><span class="membName">blackstar : </span>'+e.text+"</div>"),$(".live-text").val(""))}function n(t,e){console.log("发送聊天室"+e.type+"消息"+(t?"失败":"成功")+", id="+e.idClient,t,e);var o=JSON.parse(e.content);t||(liveRoomInterf.flash.showDanmaku("blackstar送给主播一个"+o.data.giftName,16777215,100),$(".room-block").append('<div class="gift-mes"><span class="membName">blackstar : 送给主播1个</span>'+o.data.giftName+"</div>"))}function h(e){var o=m.sendText({text:e,done:t});console.log("正在发送聊天室text消息, id="+o.idClient)}function p(t,e,a){var i={};i.giftId=e,i.num=1,i.upUserId=1,i.type=a,$.ajax({method:"GET",url:"http://localhost:30000/api/gift/send",dataType:"json",data:i,success:function(t){0==t.code?1==t.object.state||o():console.log(t.result)},error:function(t,e,o){console.log("接口出问题啦")}});var s={type:1,data:{giftName:t,giftNum:1}},c=m.sendCustomMsg({content:JSON.stringify(s),done:n});console.log("正在发送聊天室自定义消息, id="+c.idClient)}var m=Chatroom.getInstance({appKey:N,account:C,token:C,chatroomId:j,chatroomAddresses:u,onconnect:a,onerror:c,onwillreconnect:i,ondisconnect:s,onmsgs:l});liveRoomInterf={flash:null,giftlist:[],init:function(){this.flash.playLive($(".hide-rtmp").html()),this.flash.updateAnchor("123"),this.flash.updateHotWords(["666","因吹思婷","姑娘你真是条汉子","666","因吹思婷","姑娘你真是条汉子","666","因吹思婷","姑娘你真是条汉子"]),this.flash.updateCoins(f),this.flash.updateItems(r),this.flash.updateMyItems(d),this.flash.showDanmaku("我是一条弹幕",16777215,100),this.flash.showDanmaku("我是延后显示的弹幕",16776960,150,5),this.flash.showDanmaku("我是超前显示的弹幕",65535,80,-3),this.flash.showStaticDanmaku("这是一条通告",16711680,10)},refresh:function(){alert("刷新直播页面")},sendDanmaku:function(t){h(t)},recharge:function(){alert("打开充值页面")},presentGift:function(t){alert("赠送礼物："+t),e()}};var g={};g.width="100%",g.height="100%";var v={};v.quality="high",v.bgcolor="#000000",v.allowscriptaccess="sameDomain",v.allowfullscreen="true",v.allowFullScreenInteractive="true",g.id="LiveRoom",g.data="YeLiveRoom.swf",liveRoomInterf.flash=swfobject.createSWF(g,v,"LiveRoomDiv"),$(".sendText").click(function(){$(".live-text").val()&&h($(".live-text").val())}),$(".gift").click(function(){p($(this).attr("data-name"),$(this).attr("data-id"),1)}),$(".propBox").click(function(){p($(this).attr("data-name"),$(this).attr("data-id"),2)})}function a(t){console.log("进入聊天室",t),$("#chat").append("<div>你已进入聊天室！<div>")}function i(t){console.log("即将重连",t)}function s(t){if(console.log("连接断开",t),t)switch(t.code){case 302:break;case"kicked":}$("#chat").append("<div>连接断开<div>")}function c(t,e){console.log("发生错误",t,e)}function l(t){console.log("收到聊天室消息",t);for(var e=0;e<t.length;e++)if(t[e].content){var o=JSON.parse(t[e].content);o.data.giftNum>1?$("#chat").append("<div class='gift'>"+o.data.senderName+":&nbsp;&nbsp;送给主播1个"+o.data.giftName+"<span class='combo'>"+o.data.giftNum+"<i></i></span><div>"):$("#chat").append("<div class='gift'>"+o.data.senderName+":&nbsp;&nbsp;送给主播1个"+o.data.giftName+"<div>")}else if(t[e].text){var n="1"==t[e].fromNick?'<label for="">主播</label>&nbsp;':"";$("#chat").append("<div>"+n+"<span class='fromNick'>"+t[e].fromNick+":&nbsp;&nbsp;</span>"+t[e].text+"<div>")}else"in"!=t[e].flow||t[e].text||t[e].attach.fromNick||"memberEnter"!=t[e].attach.type||$("#chat").append("<div>欢迎用户"+t[e].attach.fromNick+"进入直播间")}t(),$(window).resize(function(){t()}),$(".gift").hover(function(){$(this).find(".gift-hover").show()},function(){$(this).find(".gift-hover").hide()}),$(".myGift").hover(function(){$(this).find(".my-prop").show()},function(){$(this).find(".my-prop").hide()});var r=[],d=[],f=null;e(),o();var u=[],h=new Date,p=h.getFullYear(),m=h.getMonth()+1,g=h.getDate(),v=h.getHours(),b=h.getMinutes(),x=h.getSeconds(),y=Date.UTC(p,m,g,v,b,x),j=parseInt(4174310),w=new jsSHA("SHA-1","TEXT");w.update("1981023862be1"+y);var k=w.getHash("HEX"),N="5585496885932f31d478ed0222072bcf",j="4580501",C="3835355";$.ajax({url:"https://api.netease.im/nimserver/chatroom/requestAddr.action",contentType:"application/x-www-form-urlencoded;charset=utf-8",type:"POST",beforeSend:function(t){t.setRequestHeader("appkey",N),t.setRequestHeader("Nonce",1),t.setRequestHeader("CurTime",y),t.setRequestHeader("CheckSum",k)},data:{roomid:j,accid:C}}).done(function(t){console.log(t),200===t.code?(u=t.addr,n()):alert("获取连接房间地址失败")})})},9:function(t,e){}});